openapi: "3.1.0"
info:
  title: CCDI Federation Service API
  description: REST API for querying CCDI-DCC  graph database
  version: 1.0.0
  summary: Childhood Cancer Data Initiative Federation Service
  contact:
    name: CCDI Development Team
    email: support@ccdi.org
    url: https://github.com/CBIIT/ccdi-dcc-federation-service
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  # termsOfService: https://your-server.com/terms
servers:
- url: http://localhost:8000/api/v1
  description: Local development server (default)
- url: https://dcc-dev.ccdi.cancer.gov/api/v1
  description: Dev Test server
# - url: https://ccdi-federation-test.test.com/api/v1
#   description: Test server - For online testing

paths:
  /subject:
    get:
      tags:
      - Subject
      summary: Gets the subjects known by this server.
      description: |-
        Gets the subjects known by this server.

        ### Pagination

        This endpoint is paginated. Users may override the default pagination
        parameters by providing one or more of the pagination-related query
        parameters below.

        ### Filtering

        All harmonized (top-level) and unharmonized (nested under the
        `metadata.unharmonized` key) metadata fields are filterable. To achieve
        this, you can provide the field name as a [`String`]. Filtering follows the
        following rules:

        * For single-value metadata field, the subject is included in the results if
        its value _exactly_ matches the query string. Matches are case-sensitive.
        * For multiple-value metadata fields, the subject is included in the results
        if any of its values for the field _exactly_ match the query string (a
        logical OR (`||`)). Matches are case-sensitive.
        * When the metadata field is `null` (in the case of singular or
        multiple-valued metadata fields) or empty, the subject is not included.
        * When multiple fields are provided as filters, a logical AND (`&&`) strings
        together the predicates. In other words, all filters must match for a
        subject to be returned. Note that this means that servers do not natively
        support logical OR (`||`) across multiple fields: that must be done by
        calling this endpoint with each of your desired queries and performing a
        set union of those subjects out of band.

        ### Ordering

        This endpoint has default ordering requirementsâ€”those details are documented
        in the `SubjectResponse` schema.
      operationId: subject_index
      parameters:
      - name: sex
        in: query
        description: Matches any subject where the `sex` field matches the string provided.
        required: false
        schema:
          type: string
          enum:
          - F
          - M
          - U
      - name: race
        in: query
        description: |-
          Matches any subject where any member of the `race` field matches any
          of the provided values. Multiple race values can be provided separated
          by `||` (double pipe) as delimiter. The race field in the database may
          contain semicolon-separated values (e.g., 'Asian;White'), and the filter
          will match if any of the provided values is found within those values.
          
          **Delimiter:** Only `||` (double pipe) is accepted as a delimiter for
          multiple values. All other characters (comma, ampersand, etc.) are treated
          as part of a single race value and will fail validation.
          
          **Valid race values:**
          - Not allowed to collect
          - Native Hawaiian or other Pacific Islander
          - Not Reported
          - Unknown
          - American Indian or Alaska Native
          - Asian
          - Black or African American
          - White
          
          **Examples:**
          - Single value: `?race=White`
          - Multiple values: `?race=White||Black%20or%20African%20American`
          - Invalid (comma): `?race=White,Black` - treated as single invalid value
        required: false
        schema:
          type: string
      - name: ethnicity
        in: query
        description: |-
          Matches any subject where the `ethnicity` field matches the string
          provided. Ethnicity is derived from race values: if race contains
          "Hispanic or Latino", ethnicity is "Hispanic or Latino"; otherwise
          "Not reported". Only these two values are accepted.
        required: false
        schema:
          type: string
          enum:
          - Hispanic or Latino
          - Not reported
      - name: identifiers
        in: query
        description: |-
          Matches any subject where any member of the `identifiers` field matches
          the string provided.

          **Note:** a logical OR (`||`) is performed across the values when
          determining whether the subject should be included in the results.
        required: false
        schema:
          type: string
      - name: vital_status
        in: query
        description: |-
          Matches any subject where the `vital_status` field matches the string
          provided. Valid values are: Alive, Dead, Not Reported, Unknown.
        required: false
        schema:
          type: string
          enum:
          - Alive
          - Dead
          - Not Reported
          - Unknown
      - name: age_at_vital_status
        in: query
        description: |-
          Matches any subject where the `age_at_vital_status` field matches the
          integer value provided. The age is stored in days.
          Must be a valid non-negative integer.
        required: false
        schema:
          type: integer
          minimum: 0
      - name: depositions
        in: query
        description: |-
          Filter by study_id. Matches any subject where the `depositions` field contains 
          the specified study_id value (e.g., `phs002431`). Returns all participants that 
          belong to the specified study.
          
          Example: `depositions=phs002431` will return all participants in study `phs002431`.
        required: false
        schema:
          type: string
          example: phs002431
      # - name: metadata.unharmonized.<field>
      #   in: query
      #   description: |-
      #     All unharmonized fields should be filterable in the same manner as harmonized fields:
      #
      #     * Filtering on a singular field should include the `Subject` in the results if the query exactly matches the value of that field for the `Subject` (case-sensitive).
      #     * Filtering on field with multiple values should include the `Subject` in the results if the query exactly matches any of the values of the field for that `Subject` (case-sensitive).
      #     * Unlike harmonized fields, unharmonized fields must be prefixed with `metadata.unharmonized`.
      #
      #     **Note:** this query parameter is intended to be symbolic of any unharmonized field. Because of limitations within Swagger UI, it will show up as a query parameter that can be optionally be submitted as part of a request within Swagger UI. Please keep in mind that the literal query parameter `?metadata.unharmonized.<field>=value` is not supported, so attempting to use it within Swagger UI will not work!
      #   required: false
      #   schema:
      #     type: string
      - name: page
        in: query
        description: |-
          The page to retrieve.

          This is a 1-based index of a page within a page set. The value of `page`
          **must** default to `1` when this parameter is not provided.
        required: false
        schema:
          type: integer
          default: 1
          minimum: 1
      - name: per_page
        in: query
        description: |-
          The number of results per page.

          Each server can select its own default value for `per_page` when this
          parameter is not provided. That said, the convention within the
          community is to use `100` as a default value if any value is equally
          reasonable. This server uses `20` as the default value.
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 100
      responses:
        '200':
          description: Successful operation.
          headers:
            link:
              schema:
                type: string
              description: |-
                Links to URLs that may be of interest when paging through paginated responses. This header contains two or more links of interest. The format of the field is as follows:

                `Link: <URL>; rel="REL"`

                ### Relationships

                In the format above, `URL` represents a valid URL for the link of interest and `REL` is one of four values:
                - `first` (_Required_). A link to the first page in the results (can be the same as `last` if there is only one page).
                - `last` (_Required_). A link to the last page in the results (can be the same as `first` if there is only one page).
                - `next` (_Optional_). A link to the next page (if it exists).
                - `prev` (_Optional_). A link to the previous page (if it exists).

                ### Requirements

                - This header _must_ provide links for at least the `first` and `last` rels.
                - The `prev` and `next` links must exist only (a) when there are multiple pages in the result page set and (b) when the current page is not the first or last page, respectively.
                - This list of links is unordered.

                ### Notes

                - HTTP 1.1 and HTTP 2.0 dictate that response headers are case insensitive. Though not required, we recommend an all lowercase name of `link` for this response header.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubjectResponse'
              example:
                summary:
                  counts:
                    all: 25696
                    current: 20
                data:
                - id:
                    namespace:
                      organization: CCDI-DCC
                      name: phs
                    name: TARGET-10-PAKKMW
                  kind: Participant
                  metadata:
                    sex:
                      value: F
                    race:
                    - value: White
                    ethnicity:
                      value: Not reported
                    identifiers:
                    - value:
                        namespace:
                          organization: CCDI-DCC
                          name: phs
                        name: TARGET-10-PAKKMW
                        type: Linked
                    associated_diagnoses:
                    - value: Acute Lymphoblastic Leukemia, NOS
                      owned: true
                      comment: null
                      details:
                        method: null
                        harmonizer: null
                        url: https://portal.pedscommons.org/DD?view=table
                    vital_status:
                      value: Alive
                    age_at_vital_status:
                      value: 5475
                    depositions:
                    - kind: dbGaP
                      value: phs002431
                    - kind: dbGaP
                      value: phs000463
                  gateways: []
                pagination:
                  page: 1
                  per_page: 20
                  total_pages: 1285
                  total_items: 25696
                  has_next: true
                  has_prev: false
        '404':
          description: |-
            Not found.
            Servers that cannot provide line-level data should use this response rather than Forbidden (403), as there is no level of authorization that would allow one to access the information included in the API.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: UnshareableData
                  entity: Subjects
                  message: Our agreement with data providers prohibits us from sharing line-level data.
        '400':
          description: Invalid query or path parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: InvalidParameters
                  parameters: []
                  message: "Invalid query parameter(s) provided."
                  reason: "Unknown query parameter(s)"
  /subject/{organization}/{namespace}/{name}:
    get:
      tags:
      - Subject
      summary: Gets the subject matching the provided id (if the subject exists).
      description: Gets the subject matching the provided id (if the subject exists).
      operationId: subject_show
      parameters:
      - name: organization
        in: path
        description: The organization identifier of the namespace to which the subject belongs. Defaults to 'CCDI-DCC'.
        required: true
        schema:
          type: string
          example: CCDI-DCC
          default: CCDI-DCC
      - name: namespace
        in: path
        description: The namespace identifier (study_id value) to which the subject belongs. This is the value of the study_id field from the database.
        required: true
        schema:
          type: string
          example: phs000465
      - name: name
        in: path
        description: The name portion of the subject identifier (participant ID).
        required: true
        schema:
          type: string
          example: TARGET-10-PAKKMW
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                oneOf:
                - $ref: '#/components/schemas/Subject'
                - $ref: '#/components/schemas/SubjectResponse'
        '404':
          description: |-
            Not found.
            Servers that cannot provide line-level data should use this response rather than Forbidden (403), as there is no level of authorization that would allow one to access the information included in the API.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: NotFound
                  entity: Subjects
                  message: "Unable to find data for your request."
                  reason: "No data found."
  /subject/summary:
    get:
      tags:
      - Subject
      summary: Reports summary information for the subjects known by this server.
      description: Reports summary information for the subjects known by this server.
      operationId: subject_summary
      responses:
        '200':
          description: Summary counts successfully returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SummaryResponse'
              example:
                counts:
                  total: 25696
  /subject/by/{field}/count:
    get:
      tags:
      - Subject
      summary: Groups the subjects by the specified metadata field and returns counts.
      description: Groups the subjects by the specified metadata field and returns counts.
      operationId: subjects_by_count
      parameters:
      - name: field
        in: path
        description: The field to group by and count with.
        required: true
        schema:
          type: string
          enum:
          - sex
          - race
          - ethnicity
          - vital_status
          - age_at_vital_status
          - associated_diagnoses
        examples:
          sex:
            value: sex
            summary: Count by sex
          race:
            value: race
            summary: Count by race
          ethnicity:
            value: ethnicity
            summary: Count by ethnicity
          vital_status:
            value: vital_status
            summary: Count by vital status
          age_at_vital_status:
            value: age_at_vital_status
            summary: Count by age at vital status
          associated_diagnoses:
            value: associated_diagnoses
            summary: Count by associated diagnoses
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountResponse'
        '400':
          description: Unsupported field.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: UnsupportedField
                  field: "wrong field"
                  message: "Field is not supported for subjects."
                  reason: "This field is not present for subjects."
  /:
    get:
      tags:
      - Convenience
      summary: API root JSON
      description: Returns the API root JSON configuration with available endpoints and API metadata.
      operationId: api_root
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                type: object
                properties:
                  title:
                    type: string
                    example: "CCDI DCC Federation API Server"
                  version:
                    type: string
                    example: "v1.2.0"
                  description:
                    type: string
                    example: "CCDI DCC Federation API Implementation"
                  endpoints:
                    type: object
                    description: Available API endpoints
        '404':
          description: Root not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: NotFound
                  entity: Root
                  message: "Unable to find data for your request."
                  reason: "No data found."
  /version:
    get:
      tags:
      - Convenience
      summary: Get API version
      description: Returns the current API version.
      operationId: get_version
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                    example: "v1.2.0"
                required:
                - version
  /errors/examples:
    get:
      summary: Error response examples
      description: |
        This endpoint provides example error responses for different error types.
        This is a reference endpoint showing the structure of error responses
        that may be returned by other endpoints.
        
        **Error Types:**
        - `InvalidRoute`: Returned when requesting a non-existent route
        - `InvalidParameters`: Returned when request parameters are invalid
        - `NotFound`: Returned when a requested resource is not found
        - `UnshareableData`: Returned when data cannot be shared due to agreements
        - `UnsupportedField`: Returned when a field is not supported for operations
        
        For 400 or 404 errors, always use a customized response to avoid exposing
        any internal error messages or user inputs. Any error not covered by the
        categories below should return a 404 NotFound error.
      tags:
      - Errors
      parameters:
      - name: error_type
        in: query
        description: Type of error example to return
        required: false
        schema:
          type: string
          enum:
          - InvalidRoute
          - InvalidParameters
          - NotFound
          - UnshareableData
          - UnsupportedField
          - all
          default: all
        examples:
          InvalidRoute:
            value: InvalidRoute
            summary: Invalid route error example
          InvalidParameters:
            value: InvalidParameters
            summary: Invalid parameters error example
          NotFound:
            value: NotFound
            summary: Not found error example
          UnshareableData:
            value: UnshareableData
            summary: Unshareable data error example
          UnsupportedField:
            value: UnsupportedField
            summary: Unsupported field error example
          all:
            value: all
            summary: All error examples
      responses:
        '200':
          description: Error examples successfully returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              examples:
                allErrors:
                  summary: All error examples
                  value:
                    errors:
                    - kind: InvalidRoute
                      method: GET
                      route: /foobar
                      message: 'Invalid route: GET /foobar'
                    - kind: InvalidParameters
                      parameters:
                      - id
                      message: The parameter was a non-integer value.
                      reason: "The parameter value is invalid or incorrectly formatted."
                    - kind: NotFound
                      entity: Samples
                      message: Samples not found.
                      reason: "The requested resource does not exist."
                    - kind: UnshareableData
                      entity: Sample
                      message: Our agreement with data providers prohibits us from sharing line-level data.
                      reason: "Data sharing is restricted by agreement with data providers."
                    - kind: UnsupportedField
                      field: "wrong field"
                      message: "Field is not supported: a field is not present for subject."
                      reason: "The requested field is not found."
                invalidRoute:
                  summary: Invalid route error
                  value:
                    errors:
                    - kind: InvalidRoute
                      method: GET
                      route: /foobar
                      message: 'Invalid route: GET /foobar'
                invalidParameters:
                  summary: Invalid parameters error
                  value:
                    errors:
                    - kind: InvalidParameters
                      parameters: []
                      message: "Invalid query parameter(s) provided."
                      reason: "Unknown query parameter(s)"
                notFound:
                  summary: Not found error
                  value:
                    errors:
                    - kind: NotFound
                      entity: Samples
                      message: "Unable to find data for your request."
                      reason: "No data found."
                unshareableData:
                  summary: Unshareable data error
                  value:
                    errors:
                    - kind: UnshareableData
                      entity: Sample
                      message: Our agreement with data providers prohibits us from sharing line-level data.
                      reason: "Data sharing is restricted by agreement with data providers."
                unsupportedField:
                  summary: Unsupported field error
                  value:
                    errors:
                    - kind: UnsupportedField
                      field: "wrong field"
                      message: "Field is not supported for subjects."
                      reason: "This field is not present for subjects."
  /namespace:
    get:
      tags:
      - Namespace
      summary: Gets the namespaces known by this server.
      description: Gets the namespaces known by this server.
      operationId: namespace_index
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/NamespaceEntity'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
  /namespace/{organization}/{namespace}:
    get:
      tags:
      - Namespace
      summary: Gets the namespace matching the provided name (if it exists).
      description: Gets the namespace matching the provided name (if it exists).
      operationId: namespace_show
      parameters:
      - name: organization
        in: path
        description: The organization of the namespace.
        required: true
        schema:
          type: string
      - name: namespace
        in: path
        description: The name of the namespace.
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NamespaceEntity'
        '404':
          description: Namespace not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: NotFound
                  entity: Namespaces
                  message: Namespaces not found.
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
  /organization:
    get:
      tags:
      - Organization
      summary: Gets the organizations known by this server.
      description: Gets the organizations known by this server.
      operationId: organization_index
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OrganizationEntity'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
  /organization/{name}:
    get:
      tags:
      - Organization
      summary: Gets the organization matching the provided name (if it exists).
      description: Gets the organization matching the provided name (if it exists).
      operationId: organization_show
      parameters:
      - name: name
        in: path
        description: The name of the organization.
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Successful operation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationEntity'
        '404':
          description: Not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorsResponse'
              example:
                errors:
                - kind: NotFound
                  entity: Organizations
                  message: "Unable to find data for your request."
                  reason: "No data found."
components:
  schemas:
    Subject:
      type: object
      description: Normalized participant entity returned by this service.
      properties:
        id:
          $ref: '#/components/schemas/SubjectId'
        kind:
          type: string
          example: Participant
          const: Participant
        metadata:
          $ref: '#/components/schemas/SubjectMetadata'
        gateways:
          type: array
          items:
            type: string
          default: []
      required:
      - id
      - kind
      - metadata
      - gateways
      examples:
      - id:
          namespace:
            organization: CCDI-DCC
            name: phs
          name: TARGET-10-PAKKMW
        kind: Participant
        metadata:
          sex:
            value: F
          race:
          - value: White
          ethnicity:
            value: Not reported
          identifiers:
          - value:
              namespace:
                organization: CCDI-DCC
                name: phs
              name: TARGET-10-PAKKMW
              type: Linked
          associated_diagnoses:
          - value: Acute Lymphoblastic Leukemia, NOS
            owned: true
            comment: null
            details:
              method: null
              harmonizer: null
              url: https://portal.pedscommons.org/DD?view=table
          vital_status:
            value: Alive
          age_at_vital_status:
            value: 5475
          depositions:
          - kind: dbGaP
            value: phs002431
          - kind: dbGaP
            value: phs000463
        gateways: []
    SubjectId:
      type: object
      description: Compound identifier composed of namespace and local name.
      properties:
        namespace:
          $ref: '#/components/schemas/Namespace'
        name:
          type: string
          example: TARGET-10-PAKKMW
          pattern: ^[A-Z0-9-]+$
      required:
      - namespace
      - name
    Namespace:
      type: object
      description: Authority issuing the identifier (organization plus prefixed study
        name).
      properties:
        organization:
          type: string
          example: CCDI-DCC
          const: CCDI-DCC
        name:
          type: string
          example: phs
          pattern: ^phs$
      required:
      - organization
      - name
    SubjectMetadata:
      type: object
      description: Harmonized and unharmonized attributes associated with the participant.
      properties:
        sex:
          $ref: '#/components/schemas/MetadataField'
        race:
          type: array
          items:
            $ref: '#/components/schemas/MetadataField'
          minItems: 0
        ethnicity:
          $ref: '#/components/schemas/MetadataField'
        identifiers:
          type: array
          items:
            $ref: '#/components/schemas/IdentifierField'
          minItems: 1
        associated_diagnoses:
          type: array
          items:
            $ref: '#/components/schemas/AssociatedDiagnosisField'
          minItems: 0
        vital_status:
          $ref: '#/components/schemas/MetadataField'
        age_at_vital_status:
          $ref: '#/components/schemas/MetadataField'
        depositions:
          type: array
          items:
            type: object
            properties:
              kind:
                type: string
                example: dbGaP
              value:
                type: string
                example: phs002431
          description: Array of deposition objects containing study_id values
          example:
            - kind: dbGaP
              value: phs002431
            - kind: dbGaP
              value: phs000463
      required:
      - sex
      - race
      - ethnicity
      - identifiers
      - associated_diagnoses
      - vital_status
      - age_at_vital_status
      - depositions
    MetadataField:
      type: object
      description: Scalar metadata value with optional ancestry/provenance.
      properties:
        value:
          type: string
          minLength: 1
        ancestors:
          type:
          - string
          - 'null'
          default: null
      required:
      - value
      - ancestors
    IdentifierField:
      type: object
      description: External identifier binding for the participant.
      properties:
        value:
          $ref: '#/components/schemas/IdentifierValue'
        ancestors:
          type:
          - string
          - 'null'
          default: null
      required:
      - value
      - ancestors
    IdentifierValue:
      type: object
      description: Concrete identifier value including namespace and local name.
      properties:
        namespace:
          $ref: '#/components/schemas/Namespace'
        name:
          type: string
          minLength: 1
        type:
          type: string
          description: Identifier type
          default: Linked
          example: Linked
        server:
          type: string
          description: Server URL
          nullable: true
          example: https://example.com/api/v1/subject/CCDI-DCC/phs002431/SUBJ-001
      required:
        - namespace
        - name
    AssociatedDiagnosisField:
      type: object
      description: Diagnosis term assigned to the participant with optional metadata.
      properties:
        value:
          type: string
          minLength: 1
        ancestors:
          type:
          - string
          - 'null'
          default: null
        owned:
          type: boolean
          default: true
        comment:
          type:
          - string
          - 'null'
          default: null
        details:
          $ref: '#/components/schemas/DiagnosisDetails'
      required:
      - value
      - ancestors
      - owned
      - comment
      - details
    DiagnosisDetails:
      type: object
      description: Additional details for a diagnosis value (optional metadata).
      properties:
        method:
          type:
          - string
          - 'null'
          default: null
        harmonizer:
          type:
          - string
          - 'null'
          default: null
        url:
          type: string
          example: https://portal.pedscommons.org/DD?view=table
          format: uri
      required:
      - method
      - harmonizer
      - url
    SubjectResponse:
      type: object
      description: Envelope containing source metadata, result list, and pagination
        info.
      properties:
        summary:
          $ref: '#/components/schemas/Summary'
        data:
          type: array
          items:
            $ref: '#/components/schemas/Subject'
        pagination:
          $ref: '#/components/schemas/PaginationInfo'
    Summary:
      type: object
      description: Top-level counts related to the current result set and overall
        corpus.
      properties:
        counts:
          $ref: '#/components/schemas/Counts'
    Counts:
      type: object
      description: 'Count metrics: all = total unique participants; current = items
        returned in this page.'
      properties:
        all:
          type: integer
          example: 25696
        current:
          type: integer
          example: 20
    PaginationInfo:
      type: object
      description: Pagination metadata for client navigation.
      properties:
        page:
          type: integer
          example: 1
        per_page:
          type: integer
          example: 20
        total_pages:
          type: integer
          example: 5225
        total_items:
          type: integer
          example: 25696
        has_next:
          type: boolean
          example: true
        has_prev:
          type: boolean
          example: false
    SummaryCounts:
      type: object
      description: Summary counts structure.
      properties:
        total:
          type: integer
          description: Total entity count
      required:
      - total
    SummaryResponse:
      type: object
      description: Summary-only response for endpoints that return aggregate counts.
      properties:
        counts:
          $ref: '#/components/schemas/SummaryCounts'
      required:
      - counts
    CountResponse:
      type: object
      description: Response for field counting endpoints with total, missing, and value counts.
      properties:
        total:
          type: integer
          description: Total counts of all unique participants matching filters
          example: 25696
        missing:
          type: integer
          description: Count of unique participants with null value in the field
          example: 1069
        values:
          type: array
          description: Count results for each distinct field value
          items:
            $ref: '#/components/schemas/CountResult'
      required:
      - total
      - missing
      - values
    CountResult:
      type: object
      description: Count result for a specific field value.
      properties:
        value:
          type: string
          description: The field value
          example: M
        count:
          type: integer
          description: Number of unique participants with this value
          example: 15234
      required:
      - value
      - count
    ErrorsResponse:
      type: object
      description: Error response envelope containing a list of errors.
      properties:
        errors:
          type: array
          items:
            $ref: '#/components/schemas/ErrorDetail'
      required:
      - errors
    ErrorDetail:
      type: object
      description: Individual error detail. Fields vary by error kind.
      properties:
        kind:
          type: string
          description: Error kind identifier
          enum:
          - InvalidRoute
          - InvalidParameters
          - NotFound
          - UnshareableData
          - UnsupportedField
          example: NotFound
        method:
          type: string
          description: HTTP method (for InvalidRoute errors)
          example: GET
        route:
          type: string
          description: Invalid route path (for InvalidRoute errors)
          example: /foobar
        parameters:
          type: array
          description: List of invalid parameter names (for InvalidParameters errors)
          items:
            type: string
          example:
          - id
        message:
          type: string
          description: Error message explaining what went wrong
          example: The parameter was a non-integer value.
        entity:
          type: string
          description: Entity type or identifier (for NotFound/UnshareableData errors)
          example: Samples
        field:
          type: string
          description: Field name (for UnsupportedField errors)
          example: field
        reason:
          type: string
          description: Reason for the error (for InvalidParameters, NotFound, UnshareableData, and UnsupportedField errors)
          example: "This field is not present for subjects."
      oneOf:
      - type: object
        required:
        - kind
        - method
        - route
        - message
      - type: object
        required:
        - kind
        - parameters
        - message
        - reason
      - type: object
        required:
        - kind
        - entity
        - message
        - reason
      - type: object
        required:
        - kind
        - entity
        - message
        - reason
      - type: object
        required:
        - kind
        - field
        - message
        - reason
    DepositionAccession:
      type: object
      description: Deposition accession with repository kind and value.
      properties:
        kind:
          type: string
          description: Repository type
          example: dbGaP
        value:
          type: string
          description: Accession value
          example: phs002356
      required:
        - kind
        - value
    NamespaceMetadata:
      type: object
      description: Namespace metadata with study information.
      properties:
        study_short_title:
          type: object
          description: Study short title
          nullable: true
          properties:
            value:
              type: string
              example: "short title here"
          required:
            - value
        study_name:
          type: object
          description: Study name
          nullable: true
          properties:
            value:
              type: string
              example: "name here"
          required:
            - value
        study_id:
          type: object
          description: Study identifier
          nullable: true
          properties:
            value:
              type: string
              example: "phs002356"
          required:
            - value
        study_funding_id:
          type: array
          description: Study funding identifiers
          nullable: true
          items:
            type: object
            properties:
              value:
                type: string
                example: "fund here"
            required:
              - value
        depositions:
          type: array
          description: Array of deposition objects containing study_id values
          nullable: true
          items:
            $ref: '#/components/schemas/DepositionAccession'
        deposition:
          type: string
          description: Deposition identifier
          nullable: true
    NamespaceEntity:
      type: object
      description: Namespace entity with identifier, description, and metadata.
      properties:
        id:
          $ref: '#/components/schemas/NamespaceIdentifier'
        description:
          type: string
          description: Human-readable description of the namespace
          example: Namespace for CCDI-DCC phs studies
        contact_email:
          type: string
          format: email
          description: Contact email for namespace support
          example: support@ccdi.org
        metadata:
          $ref: '#/components/schemas/NamespaceMetadata'
          nullable: true
      required:
      - id
      - description
      - contact_email
    NamespaceIdentifier:
      type: object
      description: Namespace identifier composed of organization and name.
      properties:
        organization:
          type: string
          description: Organization identifier
          example: CCDI-DCC
          const: CCDI-DCC
        name:
          type: string
          description: Namespace name (study identifier)
          example: phs
      required:
      - organization
      - name
    OrganizationEntity:
      type: object
      description: Organization entity with identifier, name, and metadata.
      properties:
        identifier:
          type: string
          description: Organization identifier
          example: CCDI-DCC
          const: CCDI-DCC
        name:
          type: string
          description: Human-readable organization name
          example: Childhood Cancer Data Initiative Data Coordinating Center
        metadata:
          type: object
          description: Additional organization metadata
          nullable: true
      required:
      - identifier
      - name
    NamespacesResponse:
      type: object
      description: Response containing a list of namespaces.
      properties:
        namespaces:
          type: array
          items:
            $ref: '#/components/schemas/NamespaceEntity'
      required:
      - namespaces
    NamespaceResponse:
      type: object
      description: Response containing a single namespace.
      properties:
        namespace:
          $ref: '#/components/schemas/NamespaceEntity'
      required:
      - namespace
    OrganizationsResponse:
      type: object
      description: Response containing a list of organizations.
      properties:
        organizations:
          type: array
          items:
            $ref: '#/components/schemas/OrganizationEntity'
      required:
      - organizations
    OrganizationResponse:
      type: object
      description: Response containing a single organization.
      properties:
        organization:
          $ref: '#/components/schemas/OrganizationEntity'
      required:
      - organization
    Error:
      type: object
      description: Standard error envelope (legacy - use ErrorsResponse).
      properties:
        detail:
          type: string
          example: Subject not found
tags:
- name: Subject
  description: Subjects within the CCDI federated ecosystem.
- name: Namespace
  description: List and describe namespaces known by this server.
- name: Organization
  description: List and describe organizations known by this server.
- name: Info
  description: API information including server, API, and data details.
- name: Convenience
  description: Convenience endpoints for API root and version information.
- name: Errors
  description: Error response examples and documentation.
